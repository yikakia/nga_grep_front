<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æ—¶ä»£æ™¯æ°”æŒ‡æ•°</title>
    <script src="https://cdn.tailwindcss.com" data-cfasync="false"></script>
    <script data-cfasync="false">
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/Chart.js/3.7.1/chart.min.js"></script>
    <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/moment-timezone/0.5.34/moment-timezone.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8M3SQNFGV5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());
        gtag('config', 'G-8M3SQNFGV5');
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
<div class="container mx-auto p-4">
    <!-- æ·±è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
    <div class="flex justify-end mb-4">
        <button id="toggleDark"
                class="flex items-center gap-1 px-3 py-2 rounded bg-gray-200 dark:bg-gray-700 dark:text-white relative"
                title="åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼">
            <span id="themeIcon">â˜€</span>
        </button>
    </div>

    <div class="w-full max-w-6xl mx-auto h-[300px] sm:h-[350px] md:h-[400px] lg:h-[500px]">
        <h1 class="text-2xl font-bold mb-4">å¤§æ—¶ä»£æ™¯æ°”æŒ‡æ•°(NGA:706)</h1>
        <div class="flex flex-wrap items-center gap-4 mb-4">
            <div>
                <label for="indicatorSelect"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">é€‰æ‹©æŒ‡æ ‡:</label>
                <select id="indicatorSelect"
                        class="shadow border rounded py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
                    <option value="">ç¯æ¯”</option>
                    <option value="ma5">MA5</option>
                    <option value="ma10">MA10</option>
                    <!--                    <option value="boll">BOLL</option>-->
                    <!--                    <option value="macd">MACD</option>-->
                </select>
            </div>
            <div>
                <label for="rangeSelect"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">å¿«é€Ÿé€‰æ‹©:</label>
                <select id="rangeSelect"
                        class="shadow border rounded w-full py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
                    <option value="2h">æœ€è¿‘2å°æ—¶</option>
                    <option value="8h">æœ€è¿‘8å°æ—¶</option>
                    <option value="24h">æœ€è¿‘24å°æ—¶</option>
                    <option value="3d">æœ€è¿‘3å¤©</option>
                    <option value="5d">æœ€è¿‘5å¤©</option>
                    <option value="7d">æœ€è¿‘7å¤©</option>
                </select>
            </div>
            <div>
                <label for="startDate"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">å¼€å§‹æ—¶é—´èŒƒå›´:</label>
                <input type="datetime-local" id="startDate"
                       class="shadow border rounded w-full py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
            </div>
            <div>
                <label for="endDate"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">ç»“æŸæ—¶é—´èŒƒå›´:</label>
                <input type="datetime-local" id="endDate"
                       class="shadow border rounded w-full py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
            </div>
            <div>
                <label for="timeInterval"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">æ—¶é—´é—´éš”:</label>
                <select id="timeInterval"
                        class="shadow border rounded w-full py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
                    <option value="5m">5 åˆ†é’Ÿ</option>
                    <option value="15m">15 åˆ†é’Ÿ</option>
                    <option value="30m">30 åˆ†é’Ÿ</option>
                    <option value="60m">1 å°æ—¶</option>
                    <option value="120m">2 å°æ—¶</option>
                    <option value="24h">1 å¤©</option>
                    <option value="168h">7 å¤©</option>
                </select>
            </div>
            <div>
                <label for="compareOffset"
                       class="block text-sm font-bold mb-2 text-gray-700 dark:text-gray-300">ç¯æ¯”åç§»:</label>
                <div class="flex gap-2">
                    <input type="number" id="compareOffset" value="0" min="0"
                           class="shadow border rounded py-2 px-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline w-24">
                    <select id="compareUnit"
                            class="shadow border rounded py-2 px-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 focus:outline-none focus:shadow-outline">
                        <option value="hours">å°æ—¶</option>
                        <option value="days">å¤©</option>
                    </select>
                </div>
            </div>
            <div>
                <button id="fetchData"
                        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                    æŸ¥è¯¢
                </button>
            </div>
        </div>

        <canvas id="timeSeriesChart" aria-label="å‘å¸–é‡ç»Ÿè®¡" role="img"
                class="bg-white dark:bg-gray-800 rounded shadow"></canvas>
    </div>
</div>

<script data-cfasync="false">
    const toggleBtn = document.getElementById('toggleDark');
    const themeIcon = document.getElementById('themeIcon');

    // åˆ‡æ¢å‡½æ•°
    function updateThemeIcon(isDark) {
        themeIcon.textContent = isDark ? 'ğŸŒ™' : 'â˜€';
        themeIcon.title = isDark ? 'åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼' : 'åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼';
        toggleBtn.title = isDark ? 'åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼' : 'åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼';
    }

    toggleBtn.addEventListener('click', () => {
        const isDark = document.documentElement.classList.toggle('dark');
        sessionStorage.setItem('theme', isDark ? 'dark' : 'light');
        updateThemeIcon(isDark);
    });

    // åˆå§‹åŒ–ä¸»é¢˜
    function applyTheme() {
        const savedTheme = sessionStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const useDark = savedTheme === 'dark' || (!savedTheme && systemPrefersDark);

        document.documentElement.classList.toggle('dark', useDark);
        updateThemeIcon(useDark);
    }

    // åˆå§‹æ‰§è¡Œ
    applyTheme();

    // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–ï¼ˆå¦‚æœç”¨æˆ·æ²¡æœ‰æ‰‹åŠ¨è®¾ç½®è¿‡ï¼‰
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        const savedTheme = sessionStorage.getItem('theme');
        if (!savedTheme) {
            document.documentElement.classList.toggle('dark', e.matches);
            updateThemeIcon(e.matches);
        }
    });

</script>

<script>
    const ctx = document.getElementById('timeSeriesChart').getContext('2d');
    let chart;

    function toUTC(dateString) {
        // Handle potential empty string or invalid date input gracefully
        if (!dateString) return null;
        const m = moment(dateString);
        return m.isValid() ? m.utc().format('YYYY-MM-DD HH:mm') : null;
    }

    function fromUTC(utcTimestamp) {
        return moment.utc(utcTimestamp).local().format('YYYY-MM-DD HH:mm');
    }

    function fetchData(startDateUTC, endDateUTC, timeInterval, indicator) { // ä¿®æ”¹ fetchData å‡½æ•°ï¼Œæ·»åŠ  indicator å‚æ•°
        // Add validation for parameters
        if (!startDateUTC || !endDateUTC || !timeInterval) {
            return Promise.reject(new Error("æ— æ•ˆçš„æŸ¥è¯¢å‚æ•°"));
        }
        // let url = `http://localhost:11648/api/timeseries?startDate=${startDateUTC}&endDate=${endDateUTC}&timeInterval=${timeInterval}`;
        let url = `https://nga_grep.yikakia.com/api/timeseries?startDate=${startDateUTC}&endDate=${endDateUTC}&timeInterval=${timeInterval}`;
        if (indicator) { // å¦‚æœé€‰æ‹©äº†æŒ‡æ ‡ï¼Œåˆ™æ·»åŠ åˆ° URL ä¸­
            url += `&indicator=${indicator}`;
        }
        console.log("Fetching data from:", url); // Log URL for debugging
        return fetch(url).then(res => {
            if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
            return res.json();
        });
    }

    function updateChart(labels, datasets) {
        if (chart) chart.destroy();

        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: datasets // ä½¿ç”¨ä¼ å…¥çš„ datasets
            },
            options: {
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'æ—¶é—´ (æœ¬åœ°æ—¶é—´)' // Clarify timezone
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'æ•°å€¼' // ä¿®æ”¹ Y è½´æ ‡é¢˜ä¸º 'æ•°å€¼'ï¼Œå› ä¸ºå¯èƒ½åŒ…å«æŒ‡æ ‡
                        },
                        beginAtZero: true // Often useful for counts
                    }
                },
                plugins: {
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                interaction: { // Improve hover performance
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                },
                responsive: true,
                maintainAspectRatio: false // Or false depending on layout needs
            }
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        // --- è·å– DOM å…ƒç´ çš„å¼•ç”¨ ---
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        const fetchDataButton = document.getElementById('fetchData');
        const timeIntervalSelect = document.getElementById('timeInterval');
        const rangeSelect = document.getElementById('rangeSelect');
        const compareOffsetInput = document.getElementById('compareOffset');
        const compareUnitSelect = document.getElementById('compareUnit');
        const indicatorSelect = document.getElementById('indicatorSelect');


        function setDateRange(range) {
            const now = moment();
            let start;
            switch (range) {
                case '2h':
                    start = moment().subtract(2, 'hours');
                    break;
                case '8h':
                    start = moment().subtract(8, 'hours');
                    break;
                case '24h':
                    start = moment().subtract(24, 'hours');
                    break;
                case '3d':
                    start = moment().subtract(3, 'days');
                    break;
                case '5d':
                    start = moment().subtract(5, 'days');
                    break;
                case '7d':
                    start = moment().subtract(7, 'days');
                    break;
                default: // å¦‚æœæœ‰è‡ªå®šä¹‰æˆ–å…¶ä»–æƒ…å†µï¼Œä¸æ¸…ç©ºè¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´
                    console.warn("æœªçŸ¥çš„å¿«é€Ÿé€‰æ‹©èŒƒå›´:", range);
                    return;
            }
            // ä½¿ç”¨ moment().local() ç¡®ä¿è¾“å…¥æ¡†æ˜¾ç¤ºçš„æ˜¯æœ¬åœ°æ—¶é—´
            startDateInput.value = start.local().format('YYYY-MM-DDTHH:mm');
            endDateInput.value = now.local().format('YYYY-MM-DDTHH:mm');
        }

        // --- äº‹ä»¶ç›‘å¬å™¨ï¼šå¿«é€Ÿé€‰æ‹©å˜åŒ– ---
        rangeSelect.addEventListener('change', () => {
            setDateRange(rangeSelect.value);
            // å½“å¿«é€Ÿé€‰æ‹©æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æŸ¥è¯¢
            fetchDataButton.click();
        });

        // ç›‘å¬æŠ€æœ¯æŒ‡æ ‡
        indicatorSelect.addEventListener('change', () => {
            const value = indicatorSelect.value;
            const disableCompare = value !== "";
            compareOffsetInput.disabled = disableCompare;
            compareUnitSelect.disabled = disableCompare;
            // å½“æŒ‡æ ‡é€‰æ‹©æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æŸ¥è¯¢
            fetchDataButton.click();
        });

        // --- äº‹ä»¶ç›‘å¬å™¨ï¼šç‚¹å‡»æŸ¥è¯¢æŒ‰é’® ---
        fetchDataButton.addEventListener('click', () => {
            const startDateLocal = startDateInput.value;
            const endDateLocal = endDateInput.value;
            const timeInterval = timeIntervalSelect.value;
            const compareOffset = parseInt(compareOffsetInput.value) || 0;
            const compareUnit = compareUnitSelect.value; // Use correct variable name
            const selectedIndicator = indicatorSelect.value; // è·å–é€‰ä¸­çš„æŒ‡æ ‡

            const startDateUTC = toUTC(startDateLocal);
            const endDateUTC = toUTC(endDateLocal);

            // --- è¾“å…¥éªŒè¯ ---
            if (!startDateUTC || !endDateUTC) {
                alert("è¯·è¾“å…¥æœ‰æ•ˆçš„å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼");
                return;
            }
            if (moment(endDateLocal).isBefore(moment(startDateLocal))) {
                alert("ç»“æŸæ—¶é—´ä¸èƒ½æ—©äºå¼€å§‹æ—¶é—´ï¼");
                return;
            }

            // è®¡ç®—å¯¹æ¯”æ—¶é—´èŒƒå›´ (ç¡®ä¿æ˜¯ UTC)
            let startCompareUTC = null;
            let endCompareUTC = null;
            if (compareOffset > 0 && !selectedIndicator) { // åªæœ‰åœ¨æ²¡æœ‰é€‰æ‹©æŒ‡æ ‡æ—¶æ‰è¿›è¡Œå¯¹æ¯”åç§»
                const startMomentUTC = moment.utc(startDateUTC);
                const endMomentUTC = moment.utc(endDateUTC);
                if (startMomentUTC.isValid() && endMomentUTC.isValid()) {
                    startCompareUTC = startMomentUTC.subtract(compareOffset, compareUnit).format('YYYY-MM-DD HH:mm');
                    endCompareUTC = endMomentUTC.subtract(compareOffset, compareUnit).format('YYYY-MM-DD HH:mm');
                } else {
                    console.error("æ— æ³•è®¡ç®—å¯¹æ¯”æ—¶é—´ï¼ŒåŸå§‹æ—¶é—´æ— æ•ˆã€‚");
                    alert("æ— æ³•è®¡ç®—å¯¹æ¯”æ—¶é—´ï¼Œè¯·æ£€æŸ¥è¾“å…¥çš„åŸå§‹æ—¶é—´ã€‚");
                    return; // Stop if base dates are invalid for comparison calc
                }
            }

            fetchDataButton.disabled = true;
            fetchDataButton.textContent = "æŸ¥è¯¢ä¸­...";
            // Consider adding a loading spinner overlay on the chart


            Promise.all([
                fetchData(startDateUTC, endDateUTC, timeInterval, selectedIndicator), // ä¼ é€’ selectedIndicator ç»™ fetchData
                // åªæœ‰åœ¨éœ€è¦å¯¹æ¯”ä¸”å¯¹æ¯”æ—¶é—´æœ‰æ•ˆ **ä¸”æ²¡æœ‰é€‰æ‹©æŒ‡æ ‡** æ—¶æ‰è·å–å¯¹æ¯”å‘å¸–é‡
                (compareOffset > 0 && startCompareUTC && endCompareUTC && !selectedIndicator)
                    ? fetchData(startCompareUTC, endCompareUTC, timeInterval, null) // å¯¹æ¯”æ•°æ®ä¸éœ€è¦æŒ‡æ ‡
                    : Promise.resolve(null) // è¿”å› null è¡¨ç¤ºæ²¡æœ‰å¯¹æ¯”å‘å¸–é‡
            ]).then(([currentData, compareData]) => {
                // --- æ•°æ®å¤„ç†å’Œå›¾è¡¨æ›´æ–° ---
                if (!currentData || !Array.isArray(currentData)) {
                    throw new Error("ä¸»æ•°æ®æ ¼å¼æ— æ•ˆ");
                }

                // æ•°æ®é›†æ•°ç»„
                const datasets = [];

                // ä¸»æ•°æ® - å‘å¸–é‡
                const labels = currentData.map(item => fromUTC(item.timestamp));
                datasets.push({
                    label: 'å½“å‰å‘å¸–é‡',
                    data: currentData.map(item => item.value),
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1,
                    pointRadius: 1, // Smaller points for dense data
                    pointHoverRadius: 5
                });

                // æŠ€æœ¯æŒ‡æ ‡æ•°æ®
                if (selectedIndicator && currentData[0] && selectedIndicator in currentData[0]) {
                    datasets.push({
                        label: selectedIndicator.toUpperCase(), // æŒ‡æ ‡åç§°ä½œä¸º label
                        data: currentData.map(item => item[selectedIndicator]), // ä»æ•°æ®ä¸­è·å–æŒ‡æ ‡å€¼
                        borderColor: 'rgb(255, 159, 64)', // æŒ‡æ ‡çº¿æ¡é¢œè‰²
                        tension: 0.1,
                        pointRadius: 1,
                        pointHoverRadius: 5
                    });
                }


                // å¯¹æ¯”å‘å¸–é‡ (åªæœ‰åœ¨æˆåŠŸè·å–åæ‰æ·»åŠ )
                if (compareData && Array.isArray(compareData) && compareData.length > 0) {
                    // é‡è¦: ç¡®ä¿å¯¹æ¯”å‘å¸–é‡çš„æ—¶é—´æˆ³æ•°é‡ä¸ä¸»æ•°æ®åŒ¹é…æˆ–è¿›è¡Œå¯¹é½å¤„ç†
                    // ç®€å•å¤„ç†ï¼šå‡è®¾APIè¿”å›çš„æ•°æ®ç‚¹æ•°å’Œæ—¶é—´é—´éš”ä¸€è‡´
                    if (compareData.length === currentData.length) {
                        datasets.push({
                            label: `å¯¹æ¯”å‘å¸–é‡ (${compareOffset}${compareUnit === 'days' ? 'å¤©' : 'å°æ—¶'}å‰)`,
                            data: compareData.map(item => item.value),
                            borderColor: 'rgb(255, 99, 132)',
                            tension: 0.1,
                            pointRadius: 1,
                            pointHoverRadius: 5,
                            borderDash: [5, 5] // <--- æ·»åŠ è¿™ä¸€è¡Œä½¿å¯¹æ¯”çº¿å˜æˆè™šçº¿
                        });
                    } else {
                        console.warn("å¯¹æ¯”å‘å¸–é‡çš„ç‚¹æ•°ä¸ä¸»æ•°æ®ä¸åŒ¹é…ï¼Œå¯èƒ½å¯¼è‡´å›¾è¡¨é”™ä½ã€‚ä¸»æ•°æ®ç‚¹æ•°:", currentData.length, "å¯¹æ¯”å‘å¸–é‡ç‚¹æ•°:", compareData.length);
                        // å¯ä»¥é€‰æ‹©ä¸æ˜¾ç¤ºå¯¹æ¯”å‘å¸–é‡æˆ–å°è¯•æ›´å¤æ‚çš„å¯¹é½é€»è¾‘
                        datasets.push({
                            label: `å¯¹æ¯”å‘å¸–é‡ (${compareOffset}${compareUnit === 'days' ? 'å¤©' : 'å°æ—¶'}å‰) - æ•°æ®ç‚¹ä¸åŒ¹é…`,
                            data: [], // Or try aligning based on timestamps if possible
                            borderColor: 'rgb(255, 99, 132)',
                            borderDash: [5, 5], // ä¿æŒè™šçº¿æç¤º
                            tension: 0.1
                        });
                    }
                } else if (compareOffset > 0 && !compareData && !selectedIndicator) { // åªæœ‰åœ¨è¯·æ±‚å¯¹æ¯”ä¸”å¤±è´¥ **ä¸”æ²¡æœ‰é€‰æ‹©æŒ‡æ ‡** æ—¶æ˜¾ç¤ºæç¤º
                    console.warn("è¯·æ±‚äº†å¯¹æ¯”å‘å¸–é‡ï¼Œä½†æœªèƒ½è·å–æˆ–æ•°æ®ä¸ºç©ºã€‚");
                    datasets.push({
                        label: `å¯¹æ¯”å‘å¸–é‡ (${compareOffset}${compareUnit === 'days' ? 'å¤©' : 'å°æ—¶'}å‰) - è·å–å¤±è´¥`,
                        data: [],
                        borderColor: 'rgb(255, 99, 132)',
                        borderDash: [5, 5], // ä¿æŒè™šçº¿æç¤º
                        tension: 0.1
                    });
                }
                // **** ä¿®æ”¹ç»“æŸ ****

                updateChart(labels, datasets); // å°†æ„å»ºå¥½çš„ datasets ä¼ é€’ç»™ updateChart

            }).catch(err => {
                console.error("æ•°æ®è·å–æˆ–å¤„ç†å¤±è´¥:", err);
                alert(`è·å–æ•°æ®å¤±è´¥: ${err.message}ã€‚è¯·æ£€æŸ¥ç½‘ç»œæˆ–æ§åˆ¶å°æ—¥å¿—ã€‚`);
                if (chart) chart.destroy();
                ctx.fillText("åŠ è½½æ•°æ®å‡ºé”™", 10, 50); // Simple error message on canvas

            }).finally(() => {
                // --- æ¢å¤æŒ‰é’®çŠ¶æ€ ---
                fetchDataButton.disabled = false;
                fetchDataButton.textContent = "æŸ¥è¯¢";
            });
        });

        // --- åˆå§‹åŒ–é»˜è®¤å€¼ ---
        console.log("Setting initial default values...");

        // 1. è®¾ç½®é»˜è®¤å¿«é€Ÿé€‰æ‹©ä¸º "æœ€è¿‘24å°æ—¶"
        rangeSelect.value = '24h';

        // 2. è®¾ç½®é»˜è®¤æ—¶é—´é—´éš”ä¸º "15åˆ†é’Ÿ"
        timeIntervalSelect.value = '15m';

        // 3. æ ¹æ®é»˜è®¤çš„ "æœ€è¿‘24å°æ—¶" è®¾ç½®å¼€å§‹å’Œç»“æŸæ—¶é—´è¾“å…¥æ¡†
        const now = moment();
        const twentyFourHoursAgo = moment().subtract(24, 'hours');
        startDateInput.value = twentyFourHoursAgo.local().format('YYYY-MM-DDTHH:mm');
        endDateInput.value = now.local().format('YYYY-MM-DDTHH:mm');
        compareUnitSelect.value = 'days'; // é»˜è®¤å¯¹æ¯”å•ä½ä¸ºå¤©

        console.log("Initial Start Date (Local):", startDateInput.value);
        console.log("Initial End Date (Local):", endDateInput.value);
        console.log("Initial Time Interval:", timeIntervalSelect.value);
        console.log("Initial Range Select:", rangeSelect.value);
        console.log("Initial compareUnit:", compareUnitSelect.value);

        console.log("Triggering initial data fetch...");
        fetchDataButton.click(); // è§¦å‘åˆå§‹æŸ¥è¯¢
    });
</script>

</body>
</html>
